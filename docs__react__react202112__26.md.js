(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[35],{WhRS:function(n,t,e){"use strict";e.r(t);var a=e("q1tI"),o=e.n(a),s=e("dEAq"),i=e("H1Ra"),r=o.a.memo((n=>{n.demos;return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"markdown"},o.a.createElement("h1",{id:"\u5b9e\u73b0history"},o.a.createElement(s["AnchorLink"],{to:"#\u5b9e\u73b0history","aria-hidden":"true",tabIndex:-1},o.a.createElement("span",{className:"icon icon-link"})),"\u5b9e\u73b0history"),o.a.createElement("h2",{id:"srchistoryindexjs"},o.a.createElement(s["AnchorLink"],{to:"#srchistoryindexjs","aria-hidden":"true",tabIndex:-1},o.a.createElement("span",{className:"icon icon-link"})),"src\\history\\index.js"),o.a.createElement(i["a"],{code:"export { default as createHashHistory } from './createHashHistory'\nexport { default as createBrowserHistory } from './createBrowserHistory'",lang:"js"}),o.a.createElement("h2",{id:"srchistorycreatebrowserhistoryjs"},o.a.createElement(s["AnchorLink"],{to:"#srchistorycreatebrowserhistoryjs","aria-hidden":"true",tabIndex:-1},o.a.createElement("span",{className:"icon icon-link"})),"src\\history\\createBrowserHistory.js"),o.a.createElement(i["a"],{code:"function createBrowserHistory() {\n  let globalHistory = window.history\n  let state;\n  let listeners = []; // \u5b58\u653e\u6240\u6709\u7684\u76d1\u542c\u51fd\u6570\n  function go(N) {\n    globalHistory.go(N)\n  }\n  function goBack() {\n    globalHistory.back()\n  }\n  function goForward() {\n    globalHistory.forward()\n  }\n\n  /**\n   * \u6dfb\u52a0\u6216\u8005\u8bf4\u8df3\u8f6c\u8def\u5f84\n   * @param pathname  \u8def\u5f84\u540d\uff0c\u53ef\u80fd\u662f\u5b57\u7b26\u4e32\uff0c\u4e5f\u53ef\u80fd\u662f{pathname, state}\n   * @param nextState\n   */\n  function push(pathname, nextState) {\n    const action = 'PUSH'\n    if (typeof pathname === 'object') {\n      state = pathname.state;\n      pathname = pathname.pathname;\n    } else {\n      state = nextState\n    }\n    globalHistory.pushState(state, null, pathname)\n    const location = {pathname, state}\n    notify({location, action})\n  }\n\n  function listen(listener) {\n    listeners.push(listener);\n    return () => {\n      listeners = listeners.filter(item => item !== listener)\n    }\n  }\n\n  window.onpopstate = (event) => {\n    let location = {pathname: window.location.pathname, state: globalHistory.state}\n    notify({location, action: 'POP'})\n  }\n\n  function notify(newState) {\n    // \u628a newState \u4e0a\u7684\u5c5e\u6027\u90fd\u62f7\u8d1d\u5230 history \u4e0a\n    Object.assign(history, newState )\n    history.length = globalHistory.length\n    listeners.forEach(listener => listener({ location: history.location, action: history.action }))\n  }\n\n  const history = {\n    action: 'POP',\n    go,\n    goBack,\n    goForward,\n    push,\n    listen,\n    location: {pathname: window.location.pathname, state: window.location.state}\n  }\n  return history\n}\n\nexport default createBrowserHistory",lang:"js"}),o.a.createElement("h2",{id:"srchistorycreatehashhistoryjs"},o.a.createElement(s["AnchorLink"],{to:"#srchistorycreatehashhistoryjs","aria-hidden":"true",tabIndex:-1},o.a.createElement("span",{className:"icon icon-link"})),"src\\history\\createHashHistory.js"),o.a.createElement(i["a"],{code:"function createHashHistory() {\n  // \u5386\u53f2\u6808\n  let historyStack = [];\n  // \u6808\u9876\u6307\u9488\n  let historyIndex = -1;\n  // \u52a8\u4f5c\u7c7b\u578b\n  let action = 'POP';\n  // \u8def\u5f84\u4e2d\u7684\u72b6\u6001\n  let state;\n  let listeners = []; // \u5b58\u653e\u6240\u6709\u7684\u76d1\u542c\u51fd\u6570\n  function go(N) {\n    action = 'POP';\n    historyIndex += N\n    let nextLocation = historyStack[historyIndex]\n    state = nextLocation.state\n    window.location.hash = nextLocation.pathname\n  }\n  function goBack() {\n    go(-1)\n  }\n  function goForward() {\n    go(1)\n  }\n\n  /**\n   * \u6dfb\u52a0\u6216\u8005\u8bf4\u8df3\u8f6c\u8def\u5f84\n   * @param pathname  \u8def\u5f84\u540d\uff0c\u53ef\u80fd\u662f\u5b57\u7b26\u4e32\uff0c\u4e5f\u53ef\u80fd\u662f{pathname, state}\n   * @param nextState\n   */\n  function push(pathname, nextState) {\n    const action = 'PUSH'\n    if (typeof pathname === 'object') {\n      state = pathname.state;\n      pathname = pathname.pathname;\n    } else {\n      state = nextState\n    }\n    // \u4fee\u6539 hash \u4e4b\u540e\u4f1a\u89e6\u53d1 hashchange\n    window.location.hash = pathname\n  }\n\n  function hashChangeHandler() {\n    let pathname = window.location.hash.slice(1);\n    Object.assign(history, { action, location: {pathname, state} })\n    if (action === 'PUSH') {\n      historyStack[++historyIndex] = history.location\n    }\n    listeners.forEach(listener => listener({ location: history.location, action: history.action }))\n  }\n\n  window.addEventListener('hashchange', hashChangeHandler)\n\n  function listen(listener) {\n    listeners.push(listener);\n    return () => {\n      listeners = listeners.filter(item => item !== listener)\n    }\n  }\n\n  const history = {\n    action: 'POP',\n    go,\n    goBack,\n    goForward,\n    push,\n    listen,\n    location: {pathname: window.location.pathname, state: window.location.state}\n  }\n  if (window.location.hash) {\n    action = 'PUSH'\n    hashChangeHandler()\n  } else {\n    window.location.hash = '/'\n  }\n  return history\n}\n\nexport default createHashHistory",lang:"js"})))}));t["default"]=n=>{var t=o.a.useContext(s["context"]),e=t.demos;return o.a.useEffect((()=>{var t;null!==n&&void 0!==n&&null!==(t=n.location)&&void 0!==t&&t.hash&&s["AnchorLink"].scrollToAnchor(decodeURIComponent(n.location.hash.slice(1)))}),[]),o.a.createElement(r,{demos:e})}}}]);