(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[13],{"2S3q":function(e,n,r){"use strict";r.r(n);var a=r("q1tI"),o=r.n(a),t=r("dEAq"),l=r("H1Ra"),c=o.a.memo((e=>{e.demos;return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"markdown"},o.a.createElement("h1",{id:"promisefinally\u7684\u5b9e\u73b0\u539f\u7406"},o.a.createElement(t["AnchorLink"],{to:"#promisefinally\u7684\u5b9e\u73b0\u539f\u7406","aria-hidden":"true",tabIndex:-1},o.a.createElement("span",{className:"icon icon-link"})),"Promise.finally\u7684\u5b9e\u73b0\u539f\u7406"),o.a.createElement("p",null,"11.finally.js"),o.a.createElement(l["a"],{code:"// 11.finally.js\n// \u65e0\u8bba\u6210\u529f\u548c\u5931\u8d25\u90fd\u4f1a\u6267\u884c\u7684\u65b9\u6cd5 \u548c try/catch/finally\u4e0d\u4e00\u6837\n\nPromise.prototype.finally = function(cb) {\n  return this.then((y) => {\n    return Promise.resolve(cb()).then(d => y)\n  }, (r) => {\n    // cb \u6267\u884c\u4e00\u65e6\u62a5\u9519 \u5c31\u76f4\u63a5\u8df3\u8fc7\u540e\u7eed\u7684 then \u7684\u903b\u8f91\uff0c\u76f4\u63a5\u5c06\u9519\u8bef\u5411\u4e0b\u4f20\u9012\n    return Promise.resolve(cb()).then(() => { throw r})\n  })\n}\n\nPromise.resolve('ok').finally(() => { // finally \u5982\u679c\u8fd4\u56de\u7684\u662f\u4e00\u4e2a promise\uff0c\u90a3\u4e48\u4f1a\u6709\u7b49\u5f85\u6548\u679c\n  console.log('\u65e0\u8bba\u6210\u529f\u5931\u8d25\u90fd\u6267\u884c')\n  return new Promise((resolve, reject) => {\n    setTimeout(() => {\n      reject('xxxxxx');     // \u5982\u679c\u662f\u5931\u8d25 \u4f1a\u7528\u8fd9\u91cc\u7684\u5931\u8d25\u4f5c\u4e3a\u5931\u8d25\u7684\u539f\u56e0\n    }, 1000)\n  })\n}).then((data) => {\n  console.log('\u6210\u529f', data)\n}).catch((err) => {\n  console.log('err', err)\n})",lang:"js"})))}));n["default"]=e=>{var n=o.a.useContext(t["context"]),r=n.demos;return o.a.useEffect((()=>{var n;null!==e&&void 0!==e&&null!==(n=e.location)&&void 0!==n&&n.hash&&t["AnchorLink"].scrollToAnchor(decodeURIComponent(e.location.hash.slice(1)))}),[]),o.a.createElement(c,{demos:r})}}}]);