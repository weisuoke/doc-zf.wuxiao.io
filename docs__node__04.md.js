(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[8],{yBay:function(e,n,s){"use strict";s.r(n);var t=s("q1tI"),o=s.n(t),a=s("dEAq"),r=s("H1Ra"),l=o.a.memo((e=>{e.demos;return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"markdown"},o.a.createElement("h1",{id:"promise\u7684\u5b9e\u73b0\u539f\u7406\u57fa\u672c\u7248"},o.a.createElement(a["AnchorLink"],{to:"#promise\u7684\u5b9e\u73b0\u539f\u7406\u57fa\u672c\u7248","aria-hidden":"true",tabIndex:-1},o.a.createElement("span",{className:"icon icon-link"})),"promise\u7684\u5b9e\u73b0\u539f\u7406\u57fa\u672c\u7248"),o.a.createElement("p",null,"6.promise.js"),o.a.createElement(r["a"],{code:"// 6.promise.js\n// Promise \u57fa\u672c\u4e0a\u4e0d\u7528\u5173\u5fc3\u6d4f\u89c8\u5668\u7684\u517c\u5bb9\u6027\n// \u6b63\u5f0f\u8bfe\u5b66\u5458 \u6700\u597d\u80fd\u81ea\u5df1\u624b\u5199 promise\n\n// Promise \u662f\u4e00\u4e2a\u7c7b \u6211\u4eec\u53ef\u4ee5 new Promise \u521b\u9020\u4e00\u4e2a\u5b9e\u4f8b\n// Promise \u6709\u4e2a\u4e09\u4e2a\u72b6\u6001 1. \u9ed8\u8ba4\u72b6\u6001\u53eb\u7b49\u5f85\u6001 pending 2. resolve\u8868\u793a\u6210\u529f\u6001 fulfilled 3. reject \u8868\u793a\u53d8\u6210\u5931\u8d25\u6001 rejected\n\n// \u53ea\u6709\u5728 pending \u7684\u72b6\u6001\u7684\u65f6\u5019\u624d\u80fd\u6539\u53d8\u72b6\u6001\uff0c\u4e0d\u80fd\u4ece\u6210\u529f\u53d8\u6210\u5931\u8d25\uff0c\u4e0d\u80fd\u4ece\u5931\u8d25\u53d8\u6210\u6210\u529f\n\n// \u6210\u529f\u6709\u6210\u529f\u7684\u539f\u56e0 \u5931\u8d25\u540c\u6837\u4e5f\u6709\u4e8b\u53d8\u7684\u539f\u56e0, \u9664\u4e86\u8c03\u7528 resolve \u548c reject \u80fd\u6539\u53d8\u72b6\u6001\u5916\uff0c\u8fd8\u53ef\u4ee5\u4f7f\u7528 throwerror \u629b\u51fa\u5f02\u5e38\u4e5f\u4f1a\u6267\u884c\u5230\u5931\u8d25\u7684\u903b\u8f91\nlet Promise = require('./promise')\nlet promise = new Promise((resolve, reject) => {\n  resolve('ok') // \u8ba9 promise \u53d8\u6210\u6210\u529f\u6001\n  reject('reason')\n})\n\npromise.then((value) => { // then \u65b9\u6cd5\u4e2d\u63d0\u4f9b\u4e24\u4e2a\u53c2\u6570 1. \u6210\u529f\u56de\u8c03 2. \u5931\u8d25\u7684\u56de\u8c03\n  console.log(value, 'success')\n}, (reason) => {\n  console.log(reason, 'fail')\n})",lang:"js"}),o.a.createElement("p",null,"promise/index.js"),o.a.createElement(r["a"],{code:'// promise/index.js\nconst PENDING = "PENDING"; // \u9ed8\u8ba4\u7b49\u5f85\u6001\nconst FULFILLED = "FULFILLED";  // \u6210\u529f\u6001\nconst REJECT = "REJECT";  // \u5931\u8d25\u6001\n\nclass Promise {\n  constructor(executor) {\n    this.status = PENDING\n    this.value = undefined\n    this.reason = undefined\n\n    this.onResolvedCallbacks = []\n    this.onRejectedCallbacks = []\n     // \u7528\u6237\u8c03\u7528 resolve \u548c reject \u53ef\u4ee5\u5c06\u5bf9\u5e94\u7684\u7ed3\u679c\u66b4\u9732\u5728\u5f53\u524d\u7684 promise \u5b9e\u4f8b\u4e0a\n    const resolve = (value) => {\n      if (this.status === PENDING) {\n        this.value = value\n        this.status = FULFILLED\n        this.onResolvedCallbacks.forEach(fn => fn())\n      }\n    }\n\n    const reject = (reason) => {\n      if (this.status === PENDING) {\n        this.reason = reason\n        this.status = REJECT\n        this.onRejectedCallbacks.forEach(fn => fn())\n      }\n    }\n\n    try {\n      executor(resolve, reject); // \u9ed8\u8ba4 new Promise\u4e2d\u7684\u51fd\u6570\u4f1a\u7acb\u5373\u6267\u884c\n    } catch (e) { // \u5982\u679c\u6267\u884c\u65f6\u51fa\u9519\uff0c\u6211\u4eec\u5c06\u9519\u8bef\u4f20\u9012\u5230 reject \u4e2d =\u300b \u6267\u884c\u5230\u4e86\u5931\u8d25\u903b\u8f91\n      reject(e)\n    }\n  }\n\n  then(onFulfilled, onRejected) {\n    if (this.status === FULFILLED) {\n      onFulfilled(this.value)\n    }\n\n    if (this.status === REJECT) {\n      onRejected(this.reason)\n    }\n\n    if (this.status === PENDING) {\n      console.log(\'pending\')\n      // \u53d1\u5e03\u8ba2\u9605\u6a21\u5f0f\n      this.onResolvedCallbacks.push(() => {\n        onFulfilled(this.value)\n      })\n      this.onRejectedCallbacks.push(() => {\n        onRejected(this.reason)\n      })\n    }\n  }\n}\n\nmodule.exports = Promise',lang:"js"})))}));n["default"]=e=>{var n=o.a.useContext(a["context"]),s=n.demos;return o.a.useEffect((()=>{var n;null!==e&&void 0!==e&&null!==(n=e.location)&&void 0!==n&&n.hash&&a["AnchorLink"].scrollToAnchor(decodeURIComponent(e.location.hash.slice(1)))}),[]),o.a.createElement(l,{demos:s})}}}]);