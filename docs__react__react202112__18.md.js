(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[26],{ZkCP:function(e,n,t){"use strict";t.r(n);var a=t("q1tI"),o=t.n(a),c=t("dEAq"),l=t("H1Ra"),r=o.a.memo((e=>{e.demos;return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"markdown"},o.a.createElement("h1",{id:"\u5b9e\u73b0usestateusememousecallback"},o.a.createElement(c["AnchorLink"],{to:"#\u5b9e\u73b0usestateusememousecallback","aria-hidden":"true",tabIndex:-1},o.a.createElement("span",{className:"icon icon-link"})),"\u5b9e\u73b0useState+useMemo+useCallback"),o.a.createElement("h2",{id:"react-hooks"},o.a.createElement(c["AnchorLink"],{to:"#react-hooks","aria-hidden":"true",tabIndex:-1},o.a.createElement("span",{className:"icon icon-link"})),"React Hooks"),o.a.createElement("ul",null,o.a.createElement("li",null,"Hook\u53ef\u4ee5\u8ba9\u4f60\u5728\u4e0d\u7f16\u5199 ",o.a.createElement("code",null,"class")," \u7684\u60c5\u51b5\u4e0b\u4f7f\u7528 ",o.a.createElement("code",null,"state")," \u4ee5\u53ca\u5176\u4ed6\u7684 React \u7279\u6027")),o.a.createElement("h2",{id:"usestate"},o.a.createElement(c["AnchorLink"],{to:"#usestate","aria-hidden":"true",tabIndex:-1},o.a.createElement("span",{className:"icon icon-link"})),"useState"),o.a.createElement("ul",null,o.a.createElement("li",null,"useState \u5c31\u662f\u4e00\u4e2a Hook"),o.a.createElement("li",null,"\u901a\u8fc7\u5728\u51fd\u6570\u7ec4\u4ef6\u91cc\u8c03\u7528\u5b83\u6765\u7ed9\u7ec4\u4ef6\u6dfb\u52a0\u4e00\u4e9b\u5185\u90e8 state,React \u4f1a\u5728\u91cd\u590d\u6e32\u67d3\u65f6\u4fdd\u7559\u8fd9\u4e2a state"),o.a.createElement("li",null,"useState \u4f1a\u8fd4\u56de\u4e00\u5bf9\u503c\uff1a\u5f53\u524d\u72b6\u6001\u548c\u4e00\u4e2a\u8ba9\u4f60\u66f4\u65b0\u5b83\u7684\u51fd\u6570\uff0c\u4f60\u53ef\u4ee5\u5728\u4e8b\u4ef6\u5904\u7406\u51fd\u6570\u4e2d\u6216\u5176\u4ed6\u4e00\u4e9b\u5730\u65b9\u8c03\u7528\u8fd9\u4e2a\u51fd\u6570\u3002\u5b83\u7c7b\u4f3c class \u7ec4\u4ef6\u7684 this.setState\uff0c\u4f46\u662f\u5b83\u4e0d\u4f1a\u628a\u65b0\u7684 state \u548c\u65e7\u7684 state \u8fdb\u884c\u5408\u5e76"),o.a.createElement("li",null,"useState \u552f\u4e00\u7684\u53c2\u6570\u5c31\u662f\u521d\u59cb state"),o.a.createElement("li",null,"\u8fd4\u56de\u4e00\u4e2a state\uff0c\u4ee5\u53ca\u66f4\u65b0 state \u7684\u51fd\u6570",o.a.createElement("ul",null,o.a.createElement("li",null,"\u5728\u521d\u59cb\u6e32\u67d3\u671f\u95f4\uff0c\u8fd4\u56de\u7684\u72b6\u6001 (state) \u4e0e\u4f20\u5165\u7684\u7b2c\u4e00\u4e2a\u53c2\u6570 (initialState) \u503c\u76f8\u540c"),o.a.createElement("li",null,"setState \u51fd\u6570\u7528\u4e8e\u66f4\u65b0 state\u3002\u5b83\u63a5\u6536\u4e00\u4e2a\u65b0\u7684 state \u503c\u5e76\u5c06\u7ec4\u4ef6\u7684\u4e00\u6b21\u91cd\u65b0\u6e32\u67d3\u52a0\u5165\u961f\u5217")))),o.a.createElement("h3",{id:"\u8ba1\u6570\u5668"},o.a.createElement(c["AnchorLink"],{to:"#\u8ba1\u6570\u5668","aria-hidden":"true",tabIndex:-1},o.a.createElement("span",{className:"icon icon-link"})),"\u8ba1\u6570\u5668"),o.a.createElement(l["a"],{code:"import React from './react';\nimport ReactDOM from './react-dom';\n\nfunction App(){\n  const[number,setNumber]=React.useState(0);\n  let handleClick = ()=> setNumber(number+1)\n  return (\n    <div>\n      <p>{number}</p>\n      <button onClick={handleClick}>+</button>\n    </div>\n  )\n}\n\nReactDOM.render(\n  <App />,\n  document.getElementById('root')\n);",lang:"js"}),o.a.createElement("h3",{id:"srcreact-domjs"},o.a.createElement(c["AnchorLink"],{to:"#srcreact-domjs","aria-hidden":"true",tabIndex:-1},o.a.createElement("span",{className:"icon icon-link"})),"src\\react-dom.js"),o.a.createElement(l["a"],{code:"+let hookStates = [];\n+let hookIndex = 0;\n+let scheduleUpdate;\n+function render(vdom, container) {\n+    mount(vdom,container);\n+    scheduleUpdate = ()=>{\n+      hookIndex = 0;\n+      compareTwoVdom(container,vdom,vdom);\n+    }\n+}\n+export function useState(initialState){\n+    hookStates[hookIndex] = hookStates[hookIndex]||initialState;\n+    let currentIndex = hookIndex; \n+    function setState(newState){\n+      let newState = typeof action === 'function' ? action(oldState) : action;\n+      hookStates[currentIndex] = newState;\n+      scheduleUpdate();\n+    }\n+    return [hookStates[hookIndex++],setState];\n+}",lang:"diff"}),o.a.createElement("h3",{id:"srcreactjs"},o.a.createElement(c["AnchorLink"],{to:"#srcreactjs","aria-hidden":"true",tabIndex:-1},o.a.createElement("span",{className:"icon icon-link"})),"src\\react.js"),o.a.createElement(l["a"],{code:"+import {useState} from './react-dom';\n\nconst React = {\n    createElement,\n    Component,\n    PureComponent,\n    createRef,\n    createContext,\n    cloneElement,\n    memo,\n+   useState\n};\nexport default React;",lang:"diff"}),o.a.createElement("h2",{id:"usecallbackusememo"},o.a.createElement(c["AnchorLink"],{to:"#usecallbackusememo","aria-hidden":"true",tabIndex:-1},o.a.createElement("span",{className:"icon icon-link"})),"useCallback+useMemo"),o.a.createElement("ul",null,o.a.createElement("li",null,"\u628a\u5185\u8054\u56de\u8c03\u51fd\u6570\u53ca\u4f9d\u8d56\u9879\u6570\u7ec4\u4f5c\u4e3a\u53c2\u6570\u4f20\u5165 ",o.a.createElement("code",null,"useCallback"),"\uff0c\u5b83\u5c06\u8fd4\u56de\u8be5\u56de\u8c03\u51fd\u6570\u7684 memoized \u7248\u672c\uff0c\u8be5\u56de\u8c03\u51fd\u6570\u4ec5\u5728\u67d0\u4e2a\u4f9d\u8d56\u9879\u6539\u53d8\u65f6\u624d\u4f1a\u66f4\u65b0"),o.a.createElement("li",null,"\u628a\u521b\u5efa\u51fd\u6570\u548c\u4f9d\u8d56\u9879\u6570\u7ec4\u4f5c\u4e3a\u53c2\u6570\u4f20\u5165 ",o.a.createElement("code",null,"useMemo"),"\uff0c\u5b83\u4ec5\u4f1a\u5728\u67d0\u4e2a\u4f9d\u8d56\u9879\u6539\u53d8\u65f6\u624d\u91cd\u65b0\u8ba1\u7b97 memoized \u503c\u3002\u8fd9\u79cd\u4f18\u5316\u6709\u52a9\u4e8e\u907f\u514d\u5728\u6bcf\u6b21\u6e32\u67d3\u65f6\u90fd\u8fdb\u884c\u9ad8\u5f00\u9500\u7684\u8ba1\u7b97")),o.a.createElement("h3",{id:"srcindexjs"},o.a.createElement(c["AnchorLink"],{to:"#srcindexjs","aria-hidden":"true",tabIndex:-1},o.a.createElement("span",{className:"icon icon-link"})),"src\\index.js"),o.a.createElement(l["a"],{code:"import React from 'react';\nimport ReactDOM from 'react-dom';\n\n\nlet  Child = ({data,handleClick})=>{\n  console.log('Child render');\n  return (\n     <button onClick={handleClick}>{data.number}</button>\n  )\n}\nChild = React.memo(Child);\n\nfunction App(){\n  console.log('App render');\n  const[name,setName]=React.useState('zhufeng');\n  const[number,setNumber]=React.useState(0);\n  let data = React.useMemo(()=>({number}),[number]);\n  let handleClick = React.useCallback(()=> setNumber(number+1),[number]);\n  return (\n    <div>\n      <input type=\"text\" value={name} onChange={event=>setName(event.target.value)}/>\n      <Child data={data} handleClick={handleClick}/>\n    </div>\n  )\n}\n\nReactDOM.render(\n  <App />,\n  document.getElementById('root')\n);",lang:"js"}),o.a.createElement("h3",{id:"srcreact-domjs-1"},o.a.createElement(c["AnchorLink"],{to:"#srcreact-domjs-1","aria-hidden":"true",tabIndex:-1},o.a.createElement("span",{className:"icon icon-link"})),"src\\react-dom.js"),o.a.createElement(l["a"],{code:"let hookStates = [];\nlet hookIndex = 0;\nlet scheduleUpdate;\nfunction render(vdom,container){\n   mount(vdom,container);\n   scheduleUpdate = ()=>{\n    hookIndex = 0;\n    compareTwoVdom(container,vdom,vdom);\n   }\n}\nexport function useState(initialState){\n    hookStates[hookIndex] = hookStates[hookIndex]||initialState;\n    let currentIndex = hookIndex; \n    function setState(newState){\n      if(typeof newState === 'function') newState=newState(hookStates[currentIndex]);\n      hookStates[currentIndex]=newState;\n      scheduleUpdate();\n    }\n    return [hookStates[hookIndex++],setState];\n  }\n+export  function useMemo(factory,deps){\n+    if(hookStates[hookIndex]){\n+      let [lastMemo,lastDeps] = hookStates[hookIndex];\n+      let same = deps.every((item,index)=>item === lastDeps[index]);\n+      if(same){\n+        hookIndex++;\n+        return lastMemo;\n+      }else{\n+        let newMemo = factory();\n+        hookStates[hookIndex++]=[newMemo,deps];\n+        return newMemo;\n+      }\n+    }else{\n+      let newMemo = factory();\n+      hookStates[hookIndex++]=[newMemo,deps];\n+      return newMemo;\n+    }\n+}\n+export function useCallback(callback,deps){\n+    if(hookStates[hookIndex]){\n+      let [lastCallback,lastDeps] = hookStates[hookIndex];\n+      let same = deps.every((item,index)=>item === lastDeps[index]);\n+      if(same){\n+        hookIndex++;\n+        return lastCallback;\n+      }else{\n+        hookStates[hookIndex++]=[callback,deps];\n+        return callback;\n+      }\n+    }else{\n+      hookStates[hookIndex++]=[callback,deps];\n+      return callback;\n+    }\n+}\nconst ReactDOM =  {\n    render\n};\nexport default ReactDOM;",lang:"diff"}),o.a.createElement("h3",{id:"srcreactjs-1"},o.a.createElement(c["AnchorLink"],{to:"#srcreactjs-1","aria-hidden":"true",tabIndex:-1},o.a.createElement("span",{className:"icon icon-link"})),"src\\react.js"),o.a.createElement(l["a"],{code:"import {wrapToVdom} from './utils';\nimport {Component,PureComponent} from './Component';\n+import {useState,useMemo,useCallback} from './react-dom';\nconst React = {\n    createElement,\n    Component,\n    PureComponent,\n    createRef,\n    createContext,\n    cloneElement,\n    memo,\n+   useMemo,\n+   useCallback,\n    useState\n};\nexport default React;",lang:"diff"})))}));n["default"]=e=>{var n=o.a.useContext(c["context"]),t=n.demos;return o.a.useEffect((()=>{var n;null!==e&&void 0!==e&&null!==(n=e.location)&&void 0!==n&&n.hash&&c["AnchorLink"].scrollToAnchor(decodeURIComponent(e.location.hash.slice(1)))}),[]),o.a.createElement(r,{demos:t})}}}]);